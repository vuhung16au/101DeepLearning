% Chapter 16, Section 3

\section{Deep Learning and Structured Models \difficultyInline{advanced}}
\label{sec:deep-structured}

\subsection{Structured Output Prediction}

Use graphical models to model output structure:

\textbf{Conditional Random Fields (CRFs):}
\begin{equation}
p(\vect{y}|\vect{x}) = \frac{1}{Z(\vect{x})} \exp\left(\sum_c \vect{w}^\top \vect{\phi}_c(\vect{x}, \vect{y}_c)\right)
\end{equation}

\textbf{Applications:}
\begin{itemize}
    \item Sequence labeling (NER, POS tagging)
    \item Image segmentation
    \item Parsing
\end{itemize}

\subsection{Structured Prediction with Neural Networks}

Combine neural networks with graphical models:
\begin{itemize}
    \item \textbf{Feature extraction:} CNN/RNN extracts features
    \item \textbf{Structured inference:} CRF layer for structured output
    \item End-to-end training with backpropagation
\end{itemize}

\textbf{Example:} CNN-CRF for semantic segmentation

\subsection{Neural Module Networks}

Compose neural modules based on program structure for visual reasoning.

\subsection{Graph Neural Networks}

Graph neural networks (GNNs) operate on graphs via message passing and permutation-invariant aggregations; useful for molecules, social networks, and scene graphs \textcite{Prince2023}.

% \subsection{Visual aids}
% \addcontentsline{toc}{subsubsection}{Visual aids (structured models)}

% \begin{figure}[h]
%   \centering
%   \begin{tikzpicture}[>=stealth]
%     \tikzstyle{b}=[draw,rounded corners,align=center,minimum width=2.2cm,minimum height=0.9cm]
%     \node[b,fill=bookpurple!10] at (0,0) (cnn) {CNN features};
%     \node[b,fill=bookpurple!15] at (3.2,0) (crf) {CRF layer};
%     \node[b,fill=bookpurple!20] at (6.4,0) (mask) {Segmentation mask};
%     \draw[->] (cnn) -- (crf);
%     \draw[->] (crf) -- (mask);
%   \end{tikzpicture}
%   \caption{CNN features feeding a CRF layer for structured output.}
%   \label{fig:cnn-crf}
% \end{figure}
