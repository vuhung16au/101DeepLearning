% Chapter 18, Section 2

\section{Contrastive Divergence \difficultyInline{advanced}}
\label{sec:contrastive-divergence}

\subsection{Motivation}

For Restricted Boltzmann Machines (RBMs):
\begin{equation}
p(\vect{v}, \vect{h}) = \frac{1}{Z} \exp(-E(\vect{v}, \vect{h}))
\end{equation}

Exact gradient requires expectations under model:
\begin{equation}
\frac{\partial \log p(\vect{v})}{\partial \theta} = -\mathbb{E}_{p(\vect{h}|\vect{v})}\left[\frac{\partial E}{\partial \theta}\right] + \mathbb{E}_{p(\vect{v}, \vect{h})}\left[\frac{\partial E}{\partial \theta}\right]
\end{equation}

\subsection{CD-k Algorithm}

Approximate second term with short MCMC chain (k steps):
\begin{enumerate}
    \item Start from data: $\vect{v}_0 = \vect{v}$
    \item Run k Gibbs steps
    \item Use $\vect{v}_k$ for negative phase
\end{enumerate}

Works surprisingly well despite being biased.

% \subsection{Visual aids}
% \addcontentsline{toc}{subsubsection}{Visual aids (contrastive divergence)}

% \begin{figure}[h]
%   \centering
%   \begin{tikzpicture}
%     \begin{axis}[
%       width=0.48\textwidth,height=0.36\textwidth,
%       xlabel={$k$ steps}, ylabel={Reconstruction error}, grid=both]
%       \addplot[bookpurple,very thick] coordinates{(1,0.20) (2,0.15) (5,0.12) (10,0.11)};
%     \end{axis}
%   \end{tikzpicture}
%   \caption{CD-$k$: reconstruction error vs. number of Gibbs steps (illustrative).}
%   \label{fig:cdk}
% \end{figure}

% \subsection{Notes and references}

% Contrastive divergence for RBMs is covered in \textcite{GoodfellowEtAl2016,Prince2023}.

