% Deep Learning 101 - Main Book File
% Author: Vu Hung Nguyen
% License: Creative Commons License Version 4.0 (CC BY 4.0)

% Define default paper size if not already defined
\providecommand{\papersize}{a5paper}
% Optional per-chapter build support: define a list of includes when building a single chapter
\providecommand{\includelist}{}

\documentclass[10pt,\papersize,twoside,openright]{book}

% Load etoolbox for conditional commands
\usepackage{etoolbox}
% If includelist is provided externally (via Makefile), only include that chapter
\ifdefempty{\includelist}{}{\includeonly{\includelist}}

% Custom paper size for trade (6"x9")
\ifdefstring{\papersize}{trade}{%
  \usepackage[paperwidth=6in,paperheight=9in,top=2cm,bottom=2cm,inner=1.8cm,outer=1.5cm]{geometry}%
}{%
  \usepackage[\papersize,top=2cm,bottom=2cm,inner=1.8cm,outer=1.5cm]{geometry}%
}

% --- Page Layout ---
% Geometry package is already loaded above with conditional sizing
\usepackage{setspace}
\onehalfspacing

% Refactored core styles
\usepackage{styles/dl101-base}
\usepackage{styles/dl101-colors}
\usepackage{styles/dl101-fonts}
\usepackage{styles/dl101-boxes}
\usepackage{styles/dl101-theorems}

% --- Essential Packages and Unicode Support ---
% etoolbox already loaded above
\usepackage{iftex}
\ifPDFTeX
  % pdfLaTeX path
  \usepackage[utf8]{inputenc}
  % Enable Latin (T1) and Vietnamese (T5) encodings
  \usepackage[T1,T5]{fontenc}
  \usepackage{lmodern}
  % Vietnamese font support
  \usepackage{vntex}
  % CJK support for Chinese characters in pdfLaTeX
  \usepackage{CJKutf8}
\else
  % XeLaTeX/LuaLaTeX path with native Unicode and CJK support
  \usepackage{fontspec}
  \defaultfontfeatures{Ligatures=TeX}
  % Use platform-specific fonts
  % Check if running in Docker (Ubuntu) by looking for /etc/os-release
  \IfFileExists{/etc/os-release}{%
    % Running in Docker/Ubuntu - use Liberation fonts
    \setmainfont{Liberation Serif}
    \setsansfont{Liberation Sans}
    \setmonofont{Liberation Mono}
  }{%
    % Running on Mac - use system fonts
    \setmainfont{Times New Roman}
    \setsansfont{Arial}
    \setmonofont{Courier New}
  }
  % Engine-specific CJK setup
  \ifXeTeX
    \RequirePackage{xeCJK}
    \setCJKmainfont{PingFang SC}
    \setCJKsansfont{PingFang SC}
    \setCJKmonofont{PingFang SC}
  \fi
  \ifLuaTeX
    % LuaLaTeX CJK support via luatexja with safe fallbacks
    \usepackage{luatexja}
    \usepackage{luatexja-fontspec}
    \IfFontExistsTF{PingFang SC}{%
      \setmainjfont{PingFang SC}
      \setsansjfont{PingFang SC}
      \setmonojfont{PingFang SC}
    }{%
      % TeX Live bundled Japanese fonts as fallback
      \setmainjfont{HaranoAjiMincho}
      \setsansjfont{HaranoAjiGothic}
      \setmonojfont{HaranoAjiGothic}
    }
  \fi
\usepackage{microtype}
% Language and date formatting
\usepackage[english]{babel}
\usepackage[en-GB]{datetime2}
\DTMsetstyle{en-GB}

% (math packages loaded by styles/dl101-base)

% --- Graphics and Colors ---
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{tikz}
\usepackage{pgfplots}
\pgfplotsset{compat=1.18}
\usepackage{eso-pic}

% (color scheme moved to styles/dl101-colors)

% --- Tables and Lists ---
\usepackage{booktabs}
\usepackage{array}
\usepackage{enumitem}

% --- Algorithm Packages ---
\usepackage{algorithm}
\usepackage{algpseudocode}

% (hyperref and cleveref loaded and configured by styles/dl101-base)

% --- Bibliography ---
\usepackage[backend=biber,style=alphabetic,sorting=nyt]{biblatex}
\addbibresource{references.bib}

% (headers/footers moved to styles/dl101-header-footer)
\usepackage{styles/dl101-header-footer}

% --- Glossary and Index ---
\usepackage{glossaries}
\makeindex
\makeglossaries
\loadglsentries{chapters/glossary}

% (boxes moved to styles)

% (theorems moved to styles)

% (math shortcuts moved to styles)

% (emoji and difficulty macros moved to styles)

% (learning objectives moved to styles)

% --- Title and Author Information ---
\title{\textbf{Deep Learning 101}}
\author{Vũ Hưng Nguyễn}
\date{\DTMtoday}

% ======================================================================
% BEGIN DOCUMENT
% ======================================================================

\begin{document}
\selectlanguage{english}

% --- Cover and Title Pages (No Front Matter Yet) ---
% Apply left-aligned text for all content
\raggedright

% Suppress page numbering completely for cover and title pages
\setcounter{page}{0}
\pagenumbering{gobble}

% Title Page - Cover Image Only (First Page)
\thispagestyle{empty}
\begingroup % Start a local scope for margin adjustments
\setlength{\topmargin}{0pt}
\setlength{\headsep}{0pt}
\setlength{\topskip}{0pt}
\setlength{\headheight}{0pt}
\setlength{\textheight}{\paperheight}
\setlength{\textwidth}{\paperwidth}
\setlength{\oddsidemargin}{0pt}
\setlength{\evensidemargin}{0pt}
\setlength{\marginparwidth}{0pt}
\setlength{\marginparsep}{0pt}
\setlength{\hoffset}{-1in}
\setlength{\voffset}{-1in}

% Draw image as exact full-page background on THIS page only
\AddToShipoutPictureBG*{%
  \AtPageLowerLeft{%
    \ifdefstring{\papersize}{a4paper}{%
      \includegraphics[width=\paperwidth,height=\paperheight]{images/DeepLearning101-cover-A4.png}%
    }{%
      \ifdefstring{\papersize}{a5paper}{%
        \includegraphics[width=\paperwidth,height=\paperheight]{images/DeepLearning101-cover-A5.png}%
      }{%
        \ifdefstring{\papersize}{letterpaper}{%
          \includegraphics[width=\paperwidth,height=\paperheight]{images/DeepLearning101-cover-letter.png}%
        }{%
          \ifdefstring{\papersize}{a6paper}{%
            \includegraphics[width=\paperwidth,height=\paperheight]{images/DeepLearning101-cover-A6.png}%
          }{%
            \ifdefstring{\papersize}{b5paper}{%
              \includegraphics[width=\paperwidth,height=\paperheight]{images/DeepLearning101-cover-B5.png}%
            }{%
              \ifdefstring{\papersize}{trade}{%
                \includegraphics[width=\paperwidth,height=\paperheight]{images/DeepLearning101-cover-trade.png}%
              }{%
                \includegraphics[width=\paperwidth,height=\paperheight]{images/DeepLearning101-cover-A5.png}%
              }%
            }%
          }%
        }%
      }%
    }%
  }%
}
\mbox{}% ensure a shipout
\endgroup % End the local scope, restoring previous margin settings
\clearpage

% Title Page - Text Content (Second Page)
\begin{titlepage}
\thispagestyle{empty}
\centering
\vspace*{\fill}

{\Huge\bfseries Deep Learning 101\par}
\vspace{2cm}

{\Large Nguyễn Vũ Hưng -- 阮武興 \par}
\vspace{2cm}

{\large A Comprehensive Guide to\\
Deep Learning Theory and Practice\par}

\vspace{3cm}

{\large \DTMtoday\par}
\vspace{1cm}

{\small License: Creative Commons Attribution 4.0 International (CC BY 4.0)\par}

\vspace*{\fill}
\end{titlepage}

% Copyright Page
\input{copyright}


% Preface Page (Page 4)
\input{preface}

% --- Front Matter ---
% Now start front matter after cover and title pages
% Reset page numbering for front matter
\setcounter{page}{1}
\pagenumbering{roman}
\frontmatter

% Table of Contents
\tableofcontents

% List of Figures
\listoffigures
\addcontentsline{toc}{chapter}{List of Figures}

% List of Tables
\listoftables
\addcontentsline{toc}{chapter}{List of Tables}

% List of Algorithms
\listofalgorithms
\addcontentsline{toc}{chapter}{List of Algorithms}

% List of Examples
\listofexamples
\addcontentsline{toc}{chapter}{List of Examples}

% List of Remarks
\listofremarks
\addcontentsline{toc}{chapter}{List of Remarks}

% List of Takeaways
% \listoftakeaways
% \addcontentsline{toc}{chapter}{List of Takeaways}

% Acknowledgements
\chapter*{Acknowledgements}
\addcontentsline{toc}{chapter}{Acknowledgements}
\input{chapters/acknowledgements}

% Notation
\chapter*{Notation}
\addcontentsline{toc}{chapter}{Notation}
\input{chapters/notation}

% --- Main Matter ---
\mainmatter

% Chapter 1: Introduction
\include{chapters/chap01}

% ======================================================================
% PART I: Basic Math and Machine Learning Foundation
% ======================================================================
\part{Basic Math and Machine Learning Foundation}

% Chapter 2: Linear Algebra
\include{chapters/chap02}

% Chapter 3: Probability and Information Theory
\include{chapters/chap03}

% Chapter 4: Numerical Computation
\include{chapters/chap04}

% Chapter 5: Classical Machine Learning Algorithms
\include{chapters/chap05}

% ======================================================================
% PART II: Practical Deep Networks
% ======================================================================
\part{Practical Deep Networks}

% Chapter 6: Deep Feedforward Networks
\include{chapters/chap06}

% Chapter 7: Regularization for Deep Learning
\include{chapters/chap07}

% Chapter 8: Optimization for Training Deep Models
\include{chapters/chap08}

% Chapter 9: Convolutional Networks
\include{chapters/chap09}

% Chapter 10: Sequence Modeling: Recurrent and Recursive Nets
\include{chapters/chap10}

% Chapter 11: Practical Methodology
\include{chapters/chap11}

% Chapter 12: Applications
\include{chapters/chap12}

% ======================================================================
% PART III: Deep Learning Research
% ======================================================================
\part{Deep Learning Research}

% Chapter 13: Linear Factor Models
\include{chapters/chap13}

% Chapter 14: Autoencoders
\include{chapters/chap14}

% Chapter 15: Representation Learning
\include{chapters/chap15}

% Chapter 16: Structured Probabilistic Models for Deep Learning
\include{chapters/chap16}

% Chapter 17: Monte Carlo Methods
\include{chapters/chap17}

% Chapter 18: Confronting the Partition Function
\include{chapters/chap18}

% Chapter 19: Approximate Inference
\include{chapters/chap19}

% Chapter 20: Deep Generative Models
\include{chapters/chap20}

% --- Back Matter ---
\backmatter

% List of Abbreviations
\include{chapters/abbreviations}

% Glossary
\printglossary[title={Glossary},toctitle={Glossary}]

% Index
\printindex

% Bibliography
\printbibliography[heading=bibintoc,title={Bibliography}]

\end{document}
