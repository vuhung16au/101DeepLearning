\ProvidesPackage{dl101-theorems}[2025/10/20 DL101 theorem environments]
\RequirePackage{tcolorbox}
\RequirePackage{keytheorems}
% Colors (assume base palette)
\colorlet{theoremblue}{bookpurple!80}
\colorlet{theoremgray}{softivory}
\colorlet{definitionblue}{bookpurple!70}

% Theorem styles
\newkeytheoremstyle{theorembox}
  {
    headfont=\bfseries\sffamily\color{bookpurple},
    bodyfont=\normalfont,
    noteseparator={ --- },
    notebraces={}{} ,
    notefont=\bfseries,
    tcolorbox-no-titlebar=
      {
        colback=theoremgray,
        colframe=theoremblue,
        sharp corners,
        boxrule=1pt,
        left=8pt,right=8pt,top=8pt,bottom=8pt,
      }
  }

\newkeytheoremstyle{definitionbox}
  {
    headfont=\bfseries\sffamily\color{bookpurple},
    bodyfont=\normalfont,
    noteseparator={ --- },
    notebraces={}{} ,
    notefont=\bfseries,
    tcolorbox-no-titlebar=
      {
        colback=white,
        colframe=definitionblue,
        sharp corners,
        boxrule=0pt,
        leftrule=4pt,
        top=8pt,bottom=8pt,left=8pt,right=8pt,
      }
  }

\newkeytheoremstyle{remarkbox}
  {
    headfont=\bfseries\sffamily\color{deepcharcoal},
    bodyfont=\normalfont\itshape,
    noteseparator={ --- },
    notebraces={}{} ,
    notefont=\bfseries,
    tcolorbox-no-titlebar=
      {
        colback=white,
        colframe=warmstone,
        sharp corners,
        boxrule=0pt,
        leftrule=2pt,
        top=4pt,bottom=4pt,left=8pt,right=8pt,
      }
  }

\newkeytheoremstyle{proofbox}
  {
    headfont=\bfseries\sffamily\color{deepcharcoal},
    bodyfont=\normalfont,
    noteseparator={ --- },
    notebraces={}{} ,
    notefont=\bfseries,
    tcolorbox-no-titlebar=
      {
        colback=white,
        colframe=warmstone!50,
        sharp corners,
        boxrule=0pt,
        toprule=0.5pt,
        top=4pt,bottom=4pt,left=8pt,right=8pt,
      }
  }

% Environments
\newkeytheorem{theorem}[parent=chapter,style=theorembox]
\newkeytheorem{lemma}[sibling=theorem,style=theorembox]
\newkeytheorem{proposition}[sibling=theorem,style=theorembox]
\newkeytheorem{corollary}[sibling=theorem,style=theorembox]
\newkeytheorem{definition}[sibling=theorem,style=definitionbox]
\newkeytheorem{example}[sibling=theorem,style=definitionbox]
\newkeytheorem{remark}[sibling=theorem,style=remarkbox]

% proof (non-numbered), fallback if amsthm didn't define it
\makeatletter
\@ifundefined{proof}{%
  \newkeytheorem{proof}[style=proofbox,numbered=false]
}{}
\makeatother

% Exercises counter
\newkeytheorem{problem}[name=Exercise,parent=chapter,style=definitionbox]

% Custom list for takeaways (since keytakeaways uses tcolorbox) - DISABLED
% \RequirePackage{tocloft}
% \newlistof{takeaways}{tak}{List of Takeaways}

% Add list entries for examples and remarks
\makeatletter
% Patch example environment to add to list - DISABLED
% \let\old@example\example
% \let\old@endexample\endexample
% \renewenvironment{example}[1][]{%
%   \old@example[#1]%
%   \@writeexample{\protect\numberline{\theexample}#1}%
% }{%
%   \old@endexample%
% }

% Patch remark environment to add to list - DISABLED
% \let\old@remark\remark
% \let\old@endremark\endremark
% \renewenvironment{remark}[1][]{%
%   \old@remark[#1]%
%   \@writeremark{\protect\numberline{\theremark}#1}%
% }{%
%   \old@endremark%
% }
\makeatother


